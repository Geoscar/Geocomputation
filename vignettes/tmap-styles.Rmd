---
title: "Map styles available in the tmap package"
author: "Robin Lovelace, Jakub Nowosad, Jannes Muenchow"
date: "`r Sys.Date()`"
output: 
  rmarkdown::html_vignette:
      toc: true
      number_sections: true
vignette: >
  %\VignetteIndexEntry{tmap-styles}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, message = FALSE, warning = FALSE, eval = F,
                      fig.width = 8, fig.height = 4)
```

This vignette builds on the [making maps chapter](https://geocompr.robinlovelace.net/adv-map.html) of [the Geocomputation with R book](https://geocompr.github.io/).

## Prerequisites {-}

The examples below assume the following packages are attached:

```{r}
library(spData) # example datasets
library(tmap)   # map creation
library(sf)
```

```{r}
world_moll = st_transform(world, crs = "+proj=moll")
```

# One color

```{r}
tm_shape(world_moll) +
  tm_polygons(col = "lightblue")
```

# Coloring of adjacent polygons

```{r}
tm_shape(world_moll) +
  tm_polygons(col = "MAP_COLORS")
```

`tmaptools::palette_explorer()`

```{r}
tm_shape(world_moll) +
  tm_polygons(col = "MAP_COLORS",
              palette = "Pastel1")
```

```{r}
tm_shape(world_moll) +
  tm_polygons(col = "MAP_COLORS",
              minimize = TRUE)
```

https://en.wikipedia.org/wiki/Four_color_theorem

# Categorical maps

`tm_polygons(col = "subregion", style = "cat")`

```{r}
tm_shape(world_moll) +
  tm_polygons(col = "subregion")+
  tm_layout(legend.outside = TRUE) 
```

# Discrete maps

## Fixed

```{r}
tm_shape(world_moll) +
  tm_polygons(col = "lifeExp", 
              style = "fixed",
              breaks = c(50, 60, 70, 80, 90),
              legend.hist = TRUE) +
  tm_layout(legend.outside = TRUE) 
```

## Pretty

The `"pretty"` style rounds breaks into whole numbers where possible and spaces them evenly.

`tm_polygons(col = "lifeExp", style = "pretty")`

```{r}
tm_shape(world_moll) +
  tm_polygons(col = "lifeExp",
              legend.hist = TRUE) +
  tm_layout(legend.outside = TRUE) 
```

<!-- n is approximation -->

```{r}
tm_shape(world_moll) +
  tm_polygons(col = "lifeExp",
              legend.hist = TRUE,
              n = 4) +
  tm_layout(legend.outside = TRUE) 
```

<!-- https://r-spatial.github.io/classInt/index.html -->


## Breaks based on the centred and scaled variable

```{r}
tm_shape(world_moll) +
  tm_polygons(col = "lifeExp", 
              style = "sd",
              legend.hist = TRUE) +
  tm_layout(legend.outside = TRUE)
```


## Jenks natural breaks 

The `"jenks"` style identifies groups of similar values in the data and maximizes the differences between categories.

```{r}
tm_shape(world_moll) +
  tm_polygons(col = "lifeExp",
              style = "jenks",
              legend.hist = TRUE) +
  tm_layout(legend.outside = TRUE) 
```

## Fisher-Jenks algorithm

```{r}
tm_shape(world_moll) +
  tm_polygons(col = "lifeExp",
              style = "fisher",
              legend.hist = TRUE) +
  tm_layout(legend.outside = TRUE) 
```

## Bagged clustering

```{r, message=FALSE}
tm_shape(world_moll) +
  tm_polygons(col = "lifeExp",
              style = "bclust",
              legend.hist = TRUE) +
  tm_layout(legend.outside = TRUE) 
```

## Hierarchical clustering

```{r}
tm_shape(world_moll) +
  tm_polygons(col = "lifeExp",
              style = "hclust",
              legend.hist = TRUE) +
  tm_layout(legend.outside = TRUE) 
```

## k-means clustering

```{r}
tm_shape(world_moll) +
  tm_polygons(col = "lifeExp", 
              style = "kmeans",
              legend.hist = TRUE) +
  tm_layout(legend.outside = TRUE) 
```

## Quantile breaks

```{r}
tm_shape(world_moll) +
  tm_polygons(col = "lifeExp", 
              style = "quantile",
              legend.hist = TRUE) +
  tm_layout(legend.outside = TRUE) 
```

## Equal breaks

The `"equal"` style divides input values into bins of equal range, and is appropriate for variables with a uniform distribution (not recommended for variables with a skewed distribution as the resulting map may end-up having little color diversity).

```{r}
tm_shape(world_moll) +
  tm_polygons(col = "lifeExp", 
              style = "equal",
              legend.hist = TRUE) +
  tm_layout(legend.outside = TRUE) 
```


## Continuous

The `"cont"` style presents a large number of colors over continuous color field.

```{r}
tm_shape(world_moll) +
  tm_polygons(col = "lifeExp",
              style = "cont") +
  tm_layout(legend.outside = TRUE) 
```

The `"order"` style also presents a large number of colors over continuous color field. 
However, this style is suited to visualize skewed distributions.

```{r}
tm_shape(world_moll) +
  tm_polygons(col = "lifeExp",
              style = "order") +
  tm_layout(legend.outside = TRUE) 
```

## Logarithmic scale

```{r}
tm_shape(world_moll) +
  tm_polygons(col = "pop") +
  tm_layout(legend.outside = TRUE) 
```

```{r}
tm_shape(world_moll) +
  tm_polygons(col = "pop", 
              style = "cont") +
  tm_layout(legend.outside = TRUE) 
```

The `"log10_pretty"` style 

```{r}
tm_shape(world_moll) +
  tm_polygons(col = "pop", 
              style = "log10_pretty") +
  tm_layout(legend.outside = TRUE) 
```

The `"log10"` style 

```{r}
tm_shape(world_moll) +
  tm_polygons(col = "pop", 
              style = "log10") +
  tm_layout(legend.outside = TRUE) 
```
